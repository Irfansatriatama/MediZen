<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Daftar â€” MediZen</title>
<link rel="stylesheet" href="auth.css">
</head>
<body>
<div class="app-shell">
  <div class="auth-orb"></div>
  <div class="auth-page">

    <div class="auth-topbar">
      <a href="login.html" class="auth-back">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5M12 5l-7 7 7 7"/></svg>
      </a>
      <div class="auth-logo-sm">MediZen</div>
      <div style="width:40px"></div>
    </div>

    <!-- Step indicator -->
    <div class="step-indicator" style="display:flex;gap:6px;margin-top:20px;animation:fadeInUp 0.4s ease both;">
      <div class="step-dot active" id="step-1-dot"></div>
      <div class="step-dot" id="step-2-dot"></div>
      <div class="step-dot" id="step-3-dot"></div>
    </div>

    <div class="auth-header" style="margin-top:20px;">
      <div class="greeting" id="step-greeting">Langkah 1 dari 3</div>
      <h1 id="step-title">Buat<br>Akun Baru</h1>
      <p id="step-desc">Bergabung dan mulai perjalanan sehatmu</p>
    </div>

    <!-- Step 1: Personal Info -->
    <div id="step-1" class="auth-form">
      <div class="form-row">
        <div class="input-group">
          <label class="input-label">Nama Depan</label>
          <div class="input-wrapper">
            <input type="text" id="fname" class="input-field" placeholder="Andi">
          </div>
        </div>
        <div class="input-group">
          <label class="input-label">Nama Belakang</label>
          <div class="input-wrapper">
            <input type="text" id="lname" class="input-field" placeholder="Pratama">
          </div>
        </div>
      </div>

      <div class="input-group">
        <label class="input-label">Tanggal Lahir</label>
        <div class="input-wrapper has-icon">
          <svg class="input-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
          <input type="date" id="dob" class="input-field">
        </div>
      </div>

      <div class="input-group">
        <label class="input-label">Jenis Kelamin</label>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <button class="gender-btn" id="gender-m" onclick="selectGender('L')">
            <span>Laki-laki</span>
          </button>
          <button class="gender-btn" id="gender-f" onclick="selectGender('P')">
            <span>Perempuan</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Step 2: Account Info -->
    <div id="step-2" class="auth-form hidden">
      <div class="input-group">
        <label class="input-label">Email</label>
        <div class="input-wrapper has-icon">
          <svg class="input-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
          <input type="email" id="email" class="input-field" placeholder="nama@email.com">
        </div>
      </div>

      <div class="input-group">
        <label class="input-label">Nomor HP</label>
        <div class="input-wrapper has-icon">
          <svg class="input-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 13a19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 3.6 2.22h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 9.91a16 16 0 0 0 6.16 6.16l.91-.91a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
          <input type="tel" id="phone" class="input-field" placeholder="08xxxxxxxxxx">
        </div>
      </div>

      <div class="input-group">
        <label class="input-label">Password</label>
        <div class="input-wrapper has-icon">
          <svg class="input-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
          <input type="password" id="password" class="input-field" placeholder="Minimal 8 karakter" oninput="checkStrength(this.value)" autocomplete="new-password">
          <button class="input-toggle" onclick="togglePassword('password', this)" type="button">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
        </div>
        <div class="password-strength">
          <div class="strength-bar" id="sb1"></div>
          <div class="strength-bar" id="sb2"></div>
          <div class="strength-bar" id="sb3"></div>
          <div class="strength-bar" id="sb4"></div>
        </div>
        <div class="strength-label" id="strength-label">Masukkan password</div>
      </div>

      <div class="input-group">
        <label class="input-label">Konfirmasi Password</label>
        <div class="input-wrapper has-icon">
          <svg class="input-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
          <input type="password" id="confirm-password" class="input-field" placeholder="Ulangi password">
        </div>
      </div>
    </div>

    <!-- Step 3: Health Profile -->
    <div id="step-3" class="auth-form hidden">
      <div class="otp-hint">
        Data ini membantu MediZen memberikan rekomendasi kesehatan yang lebih personal untukmu
      </div>

      <div class="form-row mt-16">
        <div class="input-group">
          <label class="input-label">Tinggi (cm)</label>
          <input type="number" id="height" class="input-field" placeholder="170">
        </div>
        <div class="input-group">
          <label class="input-label">Berat (kg)</label>
          <input type="number" id="weight" class="input-field" placeholder="65">
        </div>
      </div>

      <div class="input-group">
        <label class="input-label">Golongan Darah</label>
        <div class="blood-grid">
          <button class="blood-btn" onclick="selectBlood(this, 'A')">A</button>
          <button class="blood-btn" onclick="selectBlood(this, 'B')">B</button>
          <button class="blood-btn" onclick="selectBlood(this, 'AB')">AB</button>
          <button class="blood-btn" onclick="selectBlood(this, 'O')">O</button>
        </div>
      </div>

      <div class="input-group">
        <label class="input-label">Kondisi Kesehatan (opsional)</label>
        <div class="condition-chips">
          <button class="chip-btn" onclick="toggleChip(this)">Diabetes</button>
          <button class="chip-btn" onclick="toggleChip(this)">Hipertensi</button>
          <button class="chip-btn" onclick="toggleChip(this)">Asma</button>
          <button class="chip-btn" onclick="toggleChip(this)">Alergi</button>
          <button class="chip-btn" onclick="toggleChip(this)">Jantung</button>
          <button class="chip-btn" onclick="toggleChip(this)">Tidak Ada</button>
        </div>
      </div>

      <div class="checkbox-group">
        <div class="checkbox-custom" id="terms-check" onclick="toggleTerms()"></div>
        <div class="checkbox-label">
          Saya menyetujui <a href="#">Syarat & Ketentuan</a> dan <a href="#">Kebijakan Privasi</a> MediZen
        </div>
      </div>
    </div>

    <div id="alert-box" class="alert alert-error hidden mt-12">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
      <span id="alert-text"></span>
    </div>

    <div class="auth-submit">
      <button class="btn btn-primary btn-full btn-lg" id="next-btn" onclick="nextStep()">
        Lanjutkan
      </button>
    </div>

    <div class="auth-footer" id="login-link">
      Sudah punya akun? <a href="login.html">Masuk di sini</a>
    </div>

  </div>
</div>

<style>
.step-dot {
  height: 4px;
  border-radius: 2px;
  background: var(--border);
  transition: all 0.4s ease;
  flex: 1;
}
.step-dot.active { background: var(--primary); }
.step-dot.done { background: rgba(10,186,181,0.4); }

.gender-btn {
  padding: 13px;
  background: var(--bg-elevated);
  border: 1.5px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-family: var(--font-body);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
}
.gender-btn.selected {
  border-color: var(--primary);
  background: var(--primary-light);
  color: var(--primary);
}

.blood-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  margin-top: 4px;
}
.blood-btn {
  padding: 12px;
  background: var(--bg-elevated);
  border: 1.5px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-family: var(--font-display);
  font-size: 15px;
  font-weight: 700;
  cursor: pointer;
  transition: var(--transition);
}
.blood-btn.selected {
  border-color: var(--accent-orange);
  background: rgba(234,88,12,0.08);
  color: var(--accent-orange);
}

.condition-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 4px;
}
.chip-btn {
  padding: 8px 16px;
  background: var(--bg-elevated);
  border: 1.5px solid var(--border);
  border-radius: var(--radius-full);
  color: var(--text-secondary);
  font-family: var(--font-body);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
}
.chip-btn.selected {
  border-color: var(--primary);
  background: var(--primary-light);
  color: var(--primary);
}
</style>

<script src="../assets/js/utils.js"></script>
<script>
let currentStep = 1;
let selectedGender = '';
let selectedBlood = '';
let termsChecked = false;

function showAlert(msg) {
  const box = document.getElementById('alert-box');
  document.getElementById('alert-text').textContent = msg;
  box.classList.remove('hidden');
  setTimeout(() => box.classList.add('hidden'), 3000);
}

function togglePassword(id, btn) {
  const input = document.getElementById(id);
  input.type = input.type === 'text' ? 'password' : 'text';
}

function selectGender(g) {
  selectedGender = g;
  document.getElementById('gender-m').classList.toggle('selected', g === 'L');
  document.getElementById('gender-f').classList.toggle('selected', g === 'P');
}

function selectBlood(el, blood) {
  selectedBlood = blood;
  document.querySelectorAll('.blood-btn').forEach(b => b.classList.remove('selected'));
  el.classList.add('selected');
}

function toggleChip(el) { el.classList.toggle('selected'); }

function toggleTerms() {
  termsChecked = !termsChecked;
  const el = document.getElementById('terms-check');
  el.classList.toggle('checked', termsChecked);
  el.innerHTML = termsChecked ? '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round"><polyline points="20 6 9 17 4 12"/></svg>' : '';
}

function checkStrength(val) {
  const bars = [document.getElementById('sb1'), document.getElementById('sb2'), document.getElementById('sb3'), document.getElementById('sb4')];
  const label = document.getElementById('strength-label');
  let score = 0;
  if (val.length >= 8) score++;
  if (/[A-Z]/.test(val)) score++;
  if (/[0-9]/.test(val)) score++;
  if (/[^A-Za-z0-9]/.test(val)) score++;

  bars.forEach((b, i) => {
    b.classList.remove('active', 'weak', 'medium', 'strong');
    if (i < score) {
      b.classList.add('active');
      b.classList.add(score <= 1 ? 'weak' : score <= 2 ? 'medium' : 'strong');
    }
  });
  label.textContent = score === 0 ? 'Masukkan password' : score <= 1 ? 'Lemah' : score <= 2 ? 'Sedang' : score <= 3 ? 'Kuat' : 'Sangat Kuat';
  label.style.color = score <= 1 ? 'var(--accent-orange)' : score <= 2 ? '#F0E060' : 'var(--accent-green)';
}

function nextStep() {
  if (currentStep === 1) {
    const fname = document.getElementById('fname').value.trim();
    const lname = document.getElementById('lname').value.trim();
    if (!fname || !lname) { showAlert('Nama lengkap wajib diisi'); return; }
    if (!selectedGender) { showAlert('Pilih jenis kelamin terlebih dahulu'); return; }
    goToStep(2);
  } else if (currentStep === 2) {
    const email = document.getElementById('email').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const pass = document.getElementById('password').value;
    const conf = document.getElementById('confirm-password').value;
    if (!email || !email.includes('@')) { showAlert('Email tidak valid'); return; }
    if (!phone || phone.length < 10) { showAlert('Nomor HP tidak valid'); return; }
    if (!pass || pass.length < 8) { showAlert('Password minimal 8 karakter'); return; }
    if (pass !== conf) { showAlert('Konfirmasi password tidak cocok'); return; }
    goToStep(3);
  } else if (currentStep === 3) {
    if (!termsChecked) { showAlert('Setujui syarat & ketentuan terlebih dahulu'); return; }
    registerUser();
  }
}

function goToStep(n) {
  document.getElementById('step-' + currentStep).classList.add('hidden');
  document.getElementById('step-' + n).classList.remove('hidden');
  document.getElementById('step-' + currentStep + '-dot').classList.remove('active');
  document.getElementById('step-' + currentStep + '-dot').classList.add('done');
  currentStep = n;
  document.getElementById('step-' + n + '-dot').classList.add('active');

  const greetings = ['', 'Langkah 1 dari 3', 'Langkah 2 dari 3', 'Langkah terakhir!'];
  const titles = ['', 'Buat<br>Akun Baru', 'Info<br>Akun', 'Profil<br>Kesehatan'];
  const descs = ['', 'Bergabung dan mulai perjalanan sehatmu', 'Gunakan email aktifmu ya', 'Data ini hanya untukmu, dijamin aman'];
  const btnTexts = ['', 'Lanjutkan', 'Lanjutkan', 'Buat Akun'];

  document.getElementById('step-greeting').textContent = greetings[n];
  document.getElementById('step-title').innerHTML = titles[n];
  document.getElementById('step-desc').textContent = descs[n];
  document.getElementById('next-btn').textContent = btnTexts[n];
  if (n === 3) document.getElementById('login-link').classList.add('hidden');
}

function registerUser() {
  const btn = document.getElementById('next-btn');
  btn.textContent = 'Mendaftar...';
  btn.disabled = true;
  setTimeout(() => {
    const user = {
      name: document.getElementById('fname').value + ' ' + document.getElementById('lname').value,
      email: document.getElementById('email').value,
      gender: selectedGender,
      blood: selectedBlood,
      avatar: null
    };
    MediZen.auth.login(user);
    window.location.href = '../home/index.html';
  }, 1500);
}
</script>
</body>
</html>
