<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Laboratorium â€” MediZen</title>
<link rel="stylesheet" href="lab.css">
</head>
<body>
<div class="app-shell">
  <div class="lab-page">

    <!-- Header -->
    <div class="lab-header">
      <a href="../home/index.html" class="icon-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="15 18 9 12 15 6"/></svg>
      </a>
      <div class="lab-header-title">Laboratorium</div>
      <a href="../search/index.html" class="icon-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      </a>
    </div>

    <!-- Promo Banner -->
    <div class="lab-banner">
      <div class="banner-content">
        <div class="banner-eyebrow">ğŸ”¬ Promo Bulan Ini</div>
        <div class="banner-title">Cek Kesehatan<br>Lebih Terjangkau</div>
        <div class="banner-desc">Diskon 20% untuk paket kesehatan umum</div>
        <div class="banner-price">Mulai Rp 99.000</div>
      </div>
      <div class="banner-deco">ğŸ§ª</div>
    </div>

    <!-- Quick stats -->
    <div class="lab-stats-row">
      <div class="lab-stat">
        <span class="lab-stat-icon">ğŸ“¦</span>
        <span class="lab-stat-num" id="total-count">8</span>
        <span class="lab-stat-lbl">Paket</span>
      </div>
      <div class="lab-stat-sep"></div>
      <div class="lab-stat">
        <span class="lab-stat-icon">ğŸ“</span>
        <span class="lab-stat-num">4</span>
        <span class="lab-stat-lbl">Lokasi</span>
      </div>
      <div class="lab-stat-sep"></div>
      <div class="lab-stat">
        <span class="lab-stat-icon">âš¡</span>
        <span class="lab-stat-num">1 hr</span>
        <span class="lab-stat-lbl">Hasil Tercepat</span>
      </div>
    </div>

    <!-- Search -->
    <div class="lab-search">
      <div class="input-wrapper has-icon">
        <svg class="input-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input class="input-field" id="lab-search" placeholder="Cari paket pemeriksaan..." oninput="filterPackages(this.value)">
      </div>
    </div>

    <!-- Category filters -->
    <div class="lab-cats">
      <div class="lab-cat-chip active" data-cat="all" onclick="setLabCat('all', this)">Semua</div>
      <div class="lab-cat-chip" data-cat="umum" onclick="setLabCat('umum', this)">ğŸ©¸ Umum</div>
      <div class="lab-cat-chip" data-cat="jantung" onclick="setLabCat('jantung', this)">â¤ï¸ Jantung</div>
      <div class="lab-cat-chip" data-cat="diabetes" onclick="setLabCat('diabetes', this)">ğŸ¬ Diabetes</div>
      <div class="lab-cat-chip" data-cat="hormon" onclick="setLabCat('hormon', this)">âš¡ Hormon</div>
      <div class="lab-cat-chip" data-cat="alergi" onclick="setLabCat('alergi', this)">ğŸŒ¿ Alergi</div>
      <div class="lab-cat-chip" data-cat="lengkap" onclick="setLabCat('lengkap', this)">ğŸ¥ MCU</div>
    </div>

    <!-- Count info -->
    <div class="lab-count-row">
      <span id="pkg-count-txt">Menampilkan 8 paket</span>
    </div>

    <!-- Packages -->
    <div class="packages-list" id="packages-grid"></div>

    <!-- Empty -->
    <div id="lab-empty" class="lab-empty" style="display:none">
      <div class="empty-emoji">ğŸ”</div>
      <div class="empty-title">Paket tidak ditemukan</div>
      <div class="empty-desc">Coba kata kunci lain atau ubah filter kategori</div>
      <button class="btn btn-outline btn-sm" style="margin-top:14px" onclick="clearFilter()">Tampilkan Semua</button>
    </div>

  </div>

  <!-- Bottom Nav -->
    <nav class="bottom-nav">
    <a href="../home/index.html" class="nav-item">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
      <span class="nav-label">Beranda</span>
    </a>
    <a href="../search/index.html" class="nav-item">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      <span class="nav-label">Search</span>
    </a>
    <a href="../doctors/index.html" class="nav-item">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
      <span class="nav-label">Dokter</span>
    </a>
    <a href="../chatbot/index.html" class="nav-item">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
      <span class="nav-label">AI Chat</span>
    </a>
    <a href="../profile/index.html" class="nav-item">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
      <span class="nav-label">Profil</span>
    </a>
  </nav>
</div>

<script src="../assets/js/utils.js"></script>
<script>
if (!MediZen.auth.isLoggedIn()) window.location.href = '../auth/login.html';

const PACKAGES = [
  {
    id:'l1', name:'Paket Cek Darah Lengkap', category:'umum', icon:'ğŸ©¸',
    iconBg:'rgba(247,129,102,0.15)', iconColor:'#F78166',
    params:8, price:'185.000', originalPrice:'231.000', time:'1-2 hari', promo:true,
    tags:['hemoglobin','leukosit','trombosit','hematokrit','eritrosit','LED','MCV','MCH'],
    desc:'Pemeriksaan rutin komprehensif untuk deteksi anemia, infeksi, dan gangguan darah'
  },
  {
    id:'l2', name:'Paket Kolesterol & Lipid', category:'jantung', icon:'ğŸ’—',
    iconBg:'rgba(255,92,92,0.15)', iconColor:'#FF5C5C',
    params:5, price:'145.000', originalPrice:null, time:'1 hari', promo:false,
    tags:['kolesterol total','HDL','LDL','trigliserida','rasio lipid'],
    desc:'Profil lipid darah untuk pantau risiko penyakit jantung koroner'
  },
  {
    id:'l3', name:'Paket Diabetes Screening', category:'diabetes', icon:'ğŸ¬',
    iconBg:'rgba(240,192,96,0.15)', iconColor:'#F0C060',
    params:4, price:'125.000', originalPrice:'156.000', time:'1 hari', promo:true,
    tags:['gula darah puasa','2 jam PP','HbA1c','insulin'],
    desc:'Deteksi dini diabetes dan pradiabetes dengan 4 parameter kunci'
  },
  {
    id:'l4', name:'Paket Tiroid Lengkap (TSH, T3, T4)', category:'hormon', icon:'âš¡',
    iconBg:'rgba(188,140,255,0.15)', iconColor:'#BC8CFF',
    params:3, price:'210.000', originalPrice:null, time:'2-3 hari', promo:false,
    tags:['TSH','FT3','FT4'],
    desc:'Evaluasi fungsi tiroid lengkap untuk deteksi hipo/hipertiroid'
  },
  {
    id:'l5', name:'Paket Alergi Umum Panel', category:'alergi', icon:'ğŸŒ¿',
    iconBg:'rgba(57,211,83,0.15)', iconColor:'#39D353',
    params:20, price:'450.000', originalPrice:'562.000', time:'3-5 hari', promo:true,
    tags:['IgE total','panel inhalasi','panel makanan','udang','susu'],
    desc:'Panel 20 alergen inhalasi & makanan paling umum di Indonesia'
  },
  {
    id:'l6', name:'Paket Kesehatan Jantung Pro', category:'jantung', icon:'â¤ï¸',
    iconBg:'rgba(255,92,92,0.15)', iconColor:'#FF5C5C',
    params:10, price:'320.000', originalPrice:null, time:'2 hari', promo:false,
    tags:['EKG','troponin','CK-MB','kolesterol','BNP'],
    desc:'Pemeriksaan kardiovaskular menyeluruh termasuk EKG 12 Lead'
  },
  {
    id:'l7', name:'Paket Medical Check Up Dasar', category:'lengkap', icon:'ğŸ¥',
    iconBg:'rgba(10,186,181,0.15)', iconColor:'#0ABAB5',
    params:25, price:'399.000', originalPrice:'499.000', time:'2-3 hari', promo:true,
    tags:['darah','urin','gula','lipid','ginjal','hati'],
    desc:'MCU terlengkap: darah, urin, fungsi organ metabolik â€” ideal untuk pemeriksaan tahunan'
  },
  {
    id:'l8', name:'Paket Hormon Reproduksi', category:'hormon', icon:'ğŸŒ¸',
    iconBg:'rgba(188,140,255,0.15)', iconColor:'#BC8CFF',
    params:6, price:'285.000', originalPrice:null, time:'2-3 hari', promo:false,
    tags:['FSH','LH','estrogen','progesteron','prolaktin','testosteron'],
    desc:'Panel hormon reproduksi untuk wanita & pria, termasuk evaluasi kesuburan'
  },
];

MediZen.storage.set('lab_packages', PACKAGES);

let currentCat = 'all';
let searchQuery = '';

function renderPackages() {
  let list = PACKAGES;
  if (currentCat !== 'all') list = list.filter(p => p.category === currentCat);
  if (searchQuery) list = list.filter(p =>
    p.name.toLowerCase().includes(searchQuery) ||
    p.desc.toLowerCase().includes(searchQuery) ||
    p.tags.some(t => t.includes(searchQuery))
  );

  const grid = document.getElementById('packages-grid');
  const empty = document.getElementById('lab-empty');
  const countTxt = document.getElementById('pkg-count-txt');

  if (!list.length) {
    grid.innerHTML = '';
    grid.style.display = 'none';
    empty.style.display = 'flex';
    countTxt.textContent = '0 paket ditemukan';
    return;
  }

  grid.style.display = 'flex';
  empty.style.display = 'none';
  countTxt.textContent = `Menampilkan ${list.length} paket`;

  grid.innerHTML = list.map((p, i) => `
    <a href="detail.html?id=${p.id}" class="package-card" style="animation-delay:${i * 0.05}s">
      <div class="pkg-top">
        <div class="pkg-icon-wrap" style="background:${p.iconBg}">
          <span style="font-size:26px">${p.icon}</span>
        </div>
        <div class="pkg-meta">
          <div class="pkg-name">${p.name}</div>
          <div class="pkg-param-count">
            <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>
            ${p.params} parameter
          </div>
        </div>
        ${p.promo ? `<div class="pkg-promo-badge">
          <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          PROMO
        </div>` : ''}
      </div>
      <div class="pkg-desc">${p.desc}</div>
      <div class="pkg-tags">
        ${p.tags.slice(0,3).map(t => `<span class="pkg-tag">${t}</span>`).join('')}
        ${p.tags.length > 3 ? `<span class="pkg-tag pkg-tag-more">+${p.tags.length-3}</span>` : ''}
      </div>
      <div class="pkg-footer">
        <div class="pkg-price-block">
          <div class="pkg-price" style="color:${p.iconColor}">Rp ${p.price}</div>
          ${p.originalPrice ? `<div class="pkg-orig-price">Rp ${p.originalPrice}</div>` : ''}
          <div class="pkg-time-badge">
            <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            ${p.time}
          </div>
        </div>
        <div class="pkg-book-btn" style="background:${p.iconBg};color:${p.iconColor}">
          Booking
          <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polyline points="9 18 15 12 9 6"/></svg>
        </div>
      </div>
    </a>
  `).join('');
}

function setLabCat(cat, el) {
  currentCat = cat;
  document.querySelectorAll('.lab-cat-chip').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  renderPackages();
}

function filterPackages(val) {
  searchQuery = val.toLowerCase().trim();
  renderPackages();
}

function clearFilter() {
  document.getElementById('lab-search').value = '';
  searchQuery = '';
  currentCat = 'all';
  document.querySelectorAll('.lab-cat-chip').forEach(c => c.classList.remove('active'));
  document.querySelector('[data-cat="all"]').classList.add('active');
  renderPackages();
}

renderPackages();
</script>
</body>
</html>
